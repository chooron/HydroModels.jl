<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Basic Concepts · HydroModels.jl</title><meta name="title" content="Basic Concepts · HydroModels.jl"/><meta property="og:title" content="Basic Concepts · HydroModels.jl"/><meta property="twitter:title" content="Basic Concepts · HydroModels.jl"/><meta name="description" content="Documentation for HydroModels.jl."/><meta property="og:description" content="Documentation for HydroModels.jl."/><meta property="twitter:description" content="Documentation for HydroModels.jl."/><meta property="og:url" content="https://chooron.github.io/HydroModels.jl/dev/concepts_en/"/><meta property="twitter:url" content="https://chooron.github.io/HydroModels.jl/dev/concepts_en/"/><link rel="canonical" href="https://chooron.github.io/HydroModels.jl/dev/concepts_en/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/icon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">HydroModels.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../get_start_en/">Get Started with HydroModels.jl</a></li><li><span class="tocitem">tutorials</span><ul><li><a class="tocitem" href="../tutorials/framework_design/">Framework Design</a></li><li><a class="tocitem" href="../tutorials/neuralnetwork_embeding/">Neural Network Embedding</a></li><li><a class="tocitem" href="../tutorials/distribute_modeling/">Distribute Modeling</a></li><li><a class="tocitem" href="../tutorials/optimimal_parameters/">Optimal Parameters</a></li></ul></li><li class="is-active"><a class="tocitem" href>Basic Concepts</a><ul class="internal"><li><a class="tocitem" href="#Flux-class:-Water-Process-Transfer-Representation"><span>Flux class: Water Process Transfer Representation</span></a></li><li><a class="tocitem" href="#Bucket-Class:-Storage-Volume-Change-Simulation"><span>Bucket Class: Storage Volume Change Simulation</span></a></li><li><a class="tocitem" href="#Route-Class:-Spatial-Flow-Propagation"><span>Route Class: Spatial Flow Propagation</span></a></li><li><a class="tocitem" href="#Model-Class:-Hydrological-Process-Integration"><span>Model Class: Hydrological Process Integration</span></a></li><li><a class="tocitem" href="#Wrapper-Class:-Enhanced-Component-Capabilities"><span>Wrapper Class: Enhanced Component Capabilities</span></a></li></ul></li><li><span class="tocitem">Model Implementations</span><ul><li><a class="tocitem" href="../implements/build_exphydro_model_en/">construct the ExpHydro Model</a></li><li><a class="tocitem" href="../implements/build_m50_model_en/">construct the M50 Model</a></li><li><a class="tocitem" href="../implements/build_discharge_route_en/">construct the discharge route model</a></li></ul></li><li><span class="tocitem">Extend Contents</span><ul><li><a class="tocitem" href="../extent/why_not_MTK_en/">Why not using ModelingToolkit.jl directly</a></li><li><a class="tocitem" href="../extent/framework_comparision_en/">Framework Comparision</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Basic Concepts</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Basic Concepts</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/chooron/HydroModels.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/chooron/HydroModels.jl/blob/main/docs/src/concepts_en.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="HydroModels.jl-Concepts"><a class="docs-heading-anchor" href="#HydroModels.jl-Concepts">HydroModels.jl Concepts</a><a id="HydroModels.jl-Concepts-1"></a><a class="docs-heading-anchor-permalink" href="#HydroModels.jl-Concepts" title="Permalink"></a></h1><p>HydroModels.jl implements a modular and extensible architecture, designed to support diverse hydrological modeling paradigms. The framework&#39;s core structure comprises four main classes: Flux, Bucket, Route, Model and Wrapper, each playing a vital role in constructing comprehensive hydrological systems. The framework is implemented in Julia programming language for model development, computation, and parameter optimization. It leverages Lux.jl as the deep learning framework and integrates with SciML for scientific computing, symbolic programming, and parameter optimization capabilities. The conceptual framework of the model design philosophy is illustrated in the following diagram:</p><p><img src="assets/concept.jpg" alt="Framework Concept"/> Architecture and ecosystem of the HydroModels.jl framework. (a) illustrates the supporting ecosystem and its functional capabilities, highlighting the key dependencies and their roles in the framework; (b) shows the core architectural design of HydroModels.jl, demonstrating the main components and their interactions.</p><h2 id="Flux-class:-Water-Process-Transfer-Representation"><a class="docs-heading-anchor" href="#Flux-class:-Water-Process-Transfer-Representation">Flux class: Water Process Transfer Representation</a><a id="Flux-class:-Water-Process-Transfer-Representation-1"></a><a class="docs-heading-anchor-permalink" href="#Flux-class:-Water-Process-Transfer-Representation" title="Permalink"></a></h2><p>The Flux class serves as the fundamental building block of HydroModels.jl, drawing inspiration from flux library of the MARRMoT while extending its capabilities. This class encapsulates the physical equations governing water movement throughout the hydrological cycle. The conceptual formulation of the Flux class can be expressed as:</p><p class="math-container">\[\begin{aligned}
Y(t) = f(X(t),\theta) &amp;&amp; (1) \\
\end{aligned}\]</p><p>where the functional representation <span>$f$</span> maps input variables <span>$X(t)$</span> and parameters <span>$\theta$</span> to output variables <span>$Y(t)$</span>. Here, <span>$X(t)$</span> represents input variables like precipitation and temperature, <span>$\theta$</span> denotes the parameters that can be calibrated, and <span>$Y(t)$</span> represents output variables like runoff and infiltration. Based on different applications, the Flux class includes:</p><ul><li>HydroFlux: Implements fundamental hydrological processes through mathematical formulations</li><li>StateFlux: Handles mass-balance equations for state variables like soil moisture and snowpack</li><li>NeuralFlux: Uses neural networks to model processes or predict parameters, leveraging Lux.jl capabilities</li></ul><h2 id="Bucket-Class:-Storage-Volume-Change-Simulation"><a class="docs-heading-anchor" href="#Bucket-Class:-Storage-Volume-Change-Simulation">Bucket Class: Storage Volume Change Simulation</a><a id="Bucket-Class:-Storage-Volume-Change-Simulation-1"></a><a class="docs-heading-anchor-permalink" href="#Bucket-Class:-Storage-Volume-Change-Simulation" title="Permalink"></a></h2><p>The Bucket class represents fundamental water storage components within the hydrological system. It consists of multiple HydroFlux components (including NeuralFlux) and StateFlux components, which collectively define the water balance dynamics through coupled differential equations. These components can represent various hydrological stores such as soil moisture, groundwater reservoirs, and surface water bodies.</p><p>The Bucket class generates two essential functions:</p><ol><li>An ODE solver function for state variables</li><li>A hydrological flux computation function for output calculations</li></ol><p>This dual-function architecture enables efficient computation of hydrological processes, following a two-step process of solving ODEs and computing output fluxes.</p><h2 id="Route-Class:-Spatial-Flow-Propagation"><a class="docs-heading-anchor" href="#Route-Class:-Spatial-Flow-Propagation">Route Class: Spatial Flow Propagation</a><a id="Route-Class:-Spatial-Flow-Propagation-1"></a><a class="docs-heading-anchor-permalink" href="#Route-Class:-Spatial-Flow-Propagation" title="Permalink"></a></h2><p>The Route class simulates lateral water fluxes across landscapes and river networks, supporting both lumped &quot;integral&quot; and distributed &quot;differential&quot; models. Its core components include:</p><p class="math-container">\[\begin{aligned}
Q_{out}(t) &amp;= f_{rflux}(S_{route}(t),Q_{gen}(t); ps) &amp;&amp; (2) \\
\frac{dS_{route}}{dt} &amp;= Q_{in}(t) - Q_{out}(t) &amp;&amp; (3) \\
Q_{in}(t+1) &amp;= f_{aggr}(Q_{out}(t)) &amp;&amp; (4) \\
\end{aligned}\]</p><p>Where: <span>$Q_{in}$</span> is inflow, <span>$Q_{out}$</span> is outflow, <span>$S_{route}$</span> is the routing state variable, and <span>$f_{aggr}$</span> is the aggregation function.</p><p>The class supports various routing methods including:</p><ul><li>Standard state-update approaches</li><li>Unit hydrograph through convolution operations</li><li>Dynamic routing methods (Muskingum, kinematic wave)</li></ul><h2 id="Model-Class:-Hydrological-Process-Integration"><a class="docs-heading-anchor" href="#Model-Class:-Hydrological-Process-Integration">Model Class: Hydrological Process Integration</a><a id="Model-Class:-Hydrological-Process-Integration-1"></a><a class="docs-heading-anchor-permalink" href="#Model-Class:-Hydrological-Process-Integration" title="Permalink"></a></h2><p>The Model class serves as the central management component, orchestrating the integration of Flux, Bucket, and Route components. It facilitates:</p><ul><li>Construction of distributed hydrological models</li><li>Integration of vertical water movement with lateral connectivity</li><li>Systematic parameter optimization and sensitivity analysis</li><li>Efficient computation through metadata-driven approaches</li></ul><h2 id="Wrapper-Class:-Enhanced-Component-Capabilities"><a class="docs-heading-anchor" href="#Wrapper-Class:-Enhanced-Component-Capabilities">Wrapper Class: Enhanced Component Capabilities</a><a id="Wrapper-Class:-Enhanced-Component-Capabilities-1"></a><a class="docs-heading-anchor-permalink" href="#Wrapper-Class:-Enhanced-Component-Capabilities" title="Permalink"></a></h2><p>The Wrapper class extends component customization capabilities while maintaining interface uniformity. Key features include:</p><ul><li>NamedTupleIO wrapper for customized input/output specifications</li><li>EstimateParam wrapper for parameter prediction based on basin characteristics</li><li>RecordComponentState wrapper for state variable storage, supporting both batch training and online forecasting</li></ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../tutorials/optimimal_parameters/">« Optimal Parameters</a><a class="docs-footer-nextpage" href="../implements/build_exphydro_model_en/">construct the ExpHydro Model »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.10.2 on <span class="colophon-date" title="Tuesday 6 May 2025 01:46">Tuesday 6 May 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
